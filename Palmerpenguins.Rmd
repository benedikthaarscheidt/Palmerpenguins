---
title: Sexual dimorphism in Chinstrap penguins"
author: "Benedikt Haarscheidt, Jaesub Kim, Ahmed Tijani Akinfalabi "
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_depth: 5
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '5'
---

```{r echo=FALSE, include=FALSE}

library(palmerpenguins)
library(datasets)
library(MASS)
library(DAAG)
library(palmerpenguins)
```

This is the mammals datasets containing body and brain weight of 62 land species

```{r}
data(mammals)
head(mammals)
```

This is the possum database containing measurements of possums in Australia.

```{r}
data(possum)
head(possum)
```

## Data preparation

Subsetting the penguin species 
```{r}
head(penguins)
df=penguins
adelieset <- df[df$species == "Adelie", ]
adeliemale =adelieset[adelieset$sex == "male",]
adeliefemale = adelieset[adelieset$sex =="female",]
gentooset=df[df$species =="Gentoo",]
gentoomale = gentooset[gentooset$sex =="male",]
gentoofemale = gentooset[gentooset$sex =="female",]

chinstrapset=df[df$species =="Chinstrap",]
chinstrapmale=chinstrapset[chinstrapset$sex =="male",]
chinstrapfemale=chinstrapset[chinstrapset$sex =="female",]

```


```{r}
sextable=table(penguins$sex,penguins$species)
sextable
adeliesex=sextable[,1]
gentoosex=sextable[,3]
chinstrapsex=sextable[,2]

```


## Data analysis

Numerical data summary adelie:

```{r}
meanbodymassadelie=mean(adelieset$body_mass_g, na.rm=TRUE)
meanbodymassadeliemale=mean(adeliemale$body_mass_g, na.rm=TRUE)
meanbodymassadeliefemale=mean(adeliefemale$body_mass_g, na.rm=TRUE)
medianbodymassadeliemale=median(adeliemale$body_mass_g, na.rm=TRUE)
medianbodymassadeliefemale=median(adeliefemale$body_mass_g, na.rm=TRUE)

summaryadeliefemale=summary(adeliefemale[,3:6])
summaryadeliemale=summary(adeliemale[,3:6])


```

Check if the data sets of the penguins satisfy the normal distribution, to use subsequent t-test 

```{r label = shapiro-wilke-test, echo=FALSE}
a_bill_length_female = shapiro.test(adeliefemale$bill_length_mm)$p.value
a_bill_length_male = shapiro.test(adeliemale$bill_length_mm)$p.value

a_bill_depth_female = shapiro.test(adeliefemale$bill_depth_mm)$p.value
a_bill_depth_male = shapiro.test(adeliemale$bill_depth_mm)$p.value

a_flipper_length_female = shapiro.test(adeliefemale$flipper_length_mm)$p.value
a_flipper_length_male = shapiro.test(adeliemale$flipper_length_mm)$p.value

a_body_mass_female = shapiro.test(adeliefemale$body_mass_g)$p.value
a_body_mass_male = shapiro.test(adeliemale$body_mass_g)$p.value


adelishapiro = data.frame(a_bill_length_female,a_bill_length_male,a_bill_depth_female,a_bill_depth_male, a_flipper_length_female,a_flipper_length_male,a_body_mass_female,a_body_mass_male)

adelishapiro > 0.05


c_bill_length_female = shapiro.test(chinstrapfemale$bill_length_mm)$p.value
c_bill_length_male = shapiro.test(chinstrapmale$bill_length_mm)$p.value

c_bill_depth_female = shapiro.test(chinstrapfemale$bill_depth_mm)$p.value
c_bill_depth_male = shapiro.test(chinstrapmale$bill_depth_mm)$p.value

c_flipper_length_female = shapiro.test(chinstrapfemale$flipper_length_mm)$p.value
c_flipper_length_male = shapiro.test(chinstrapmale$flipper_length_mm)$p.value

c_body_mass_female = shapiro.test(chinstrapfemale$body_mass_g)$p.value
c_body_mass_male = shapiro.test(chinstrapmale$body_mass_g)$p.value


chinshapiro = data.frame(c_bill_length_female,c_bill_length_male,c_bill_depth_female,c_bill_depth_male, c_flipper_length_female,c_flipper_length_male,c_body_mass_female,c_body_mass_male)

chinshapiro>0.05

g_bill_length_female = shapiro.test(gentoofemale$bill_length_mm)$p.value
g_bill_length_male = shapiro.test(gentoomale$bill_length_mm)$p.value

g_bill_depth_female = shapiro.test(gentoofemale$bill_depth_mm)$p.value
g_bill_depth_male = shapiro.test(gentoomale$bill_depth_mm)$p.value

g_flipper_length_female = shapiro.test(gentoofemale$flipper_length_mm)$p.value
g_flipper_length_male = shapiro.test(gentoomale$flipper_length_mm)$p.value

g_body_mass_female = shapiro.test(gentoofemale$body_mass_g)$p.value
g_body_mass_male = shapiro.test(gentoomale$body_mass_g)$p.value


gentooshapiro = data.frame(g_bill_length_female,g_bill_length_male,g_bill_depth_female,g_bill_depth_male, g_flipper_length_female,g_flipper_length_male,g_body_mass_female,g_body_mass_male)

gentooshapiro>0.05
```


```{r}

```

## Plots:

Stripcharts for all the attributes
```{r}
stripchart(adelieset$body_mass_g~adelieset$sex, main="Massdistribution between the biological sexes",method="stack", col=c(2,4))
stripchart(adelieset$bill_length_mm~adelieset$sex, main="Massdistribution between the biological sexes",method="stack", col=c(2,4))
stripchart(adelieset$flipper_length_mm~adelieset$sex, main="Massdistribution between the biological sexes",method="stack", col=c(2,4))
stripchart(adelieset$bill_depth_mm~adelieset$sex, main="Massdistribution between the biological sexes",method="stack", col=c(2,4))

```

```{r}

# Increase margins to make space for text and adjust plot layout
old_par <- par()  # Save current settings to restore later
par(mar = c(5, 4, 4, 4) + 0.1)  # Increase right margin for text

# Summary statistics
xy <- summary(adeliemale$body_mass_g)

# Create a histogram
hist(adeliemale$body_mass_g,
     main = "Histogram of Body Mass of Male Adelie Penguins",
     xlab = "Body Mass Distribution",
     ylab = "Density",
     col = "lightblue",
     freq = FALSE, # Using density instead of frequency
     xlim = range(adeliemale$body_mass_g, na.rm = TRUE)) # Set x-axis limits

# Add density line, mean, and median lines
lines(density(adeliemale$body_mass_g, na.rm = TRUE), col = "blue", lwd = 2)
abline(v = meanbodymassadeliemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymassadeliemale, col = "red", lwd = 2, lty = 2)
abline(v = meanbodymassadeliefemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymassadeliefemale, col = "red", lwd = 2, lty = 1)

# Adjust legend position
legend("topright", inset = c(0, -0.1), # Shift legend up
       legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("blue", "black", "red", "black", "red"), lty = c(1, 2, 2, 1, 1), lwd = 2)

# Prepare a text to display
summary_text <- paste("Min:", xy["Min."], "\n",
                      "1st Qu.:", xy["1st Qu."], "\n",
                      "Median:", xy["Median"], "\n",
                      "Mean:", xy["Mean"], "\n",
                      "3rd Qu.:", xy["3rd Qu."], "\n",
                      "Max:", xy["Max."], "\n")

# Place the summary text in the right margin
mtext(summary_text, side = 4, line = 1, cex = 0.8, adj = 0)

# Restore original par settings
par(old_par)
```