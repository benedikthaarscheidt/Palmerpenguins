---
title: Sexual dimorphism in Chinstrap penguins"
author: "Benedikt Haarscheidt, Jaesub Kim, Ahmed Tijani Akinfalabi "
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_depth: 5
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '5'
---
```{r echo=FALSE, include=FALSE}

library(palmerpenguins)
library(datasets)
library(MASS)
library(effsize)
library(DAAG)
library(palmerpenguins)
library(knitr)
```

This is the mammals dataset containing body and brain weigth of 62 land Species
```{r}
data(mammals)
head(mammals)


```
This is the possum datase containing measurments of possums in australia 
```{r}
data(possum)
head(possum)
```



```{r}
data(penguins_raw)
head(penguins_raw)
```


## Data preparation

Subsetting the penguin Species 
```{r}
head(penguins)
df=penguins_raw
adelieset <- df[df$Species == "Adelie Penguin (Pygoscelis adeliae)", ]
adeliemale =adelieset[adelieset$Sex == "MALE",]
adeliefemale = adelieset[adelieset$Sex =="FEMALE",]

gentooset=df[df$Species =="Gentoo penguin (Pygoscelis papua)",]
gentoomale = gentooset[gentooset$Sex =="MALE",]
gentoofemale = gentooset[gentooset$Sex =="FEMALE",]

chinstrapset=df[df$Species =="Chinstrap penguin (Pygoscelis antarctica)",]
chinstrapmale=chinstrapset[chinstrapset$Sex =="MALE",]
chinstrapfemale=chinstrapset[chinstrapset$Sex =="FEMALE",]

head(chinstrapmale)
head(chinstrapfemale)


# Standard deviation of Chinstrap Male

male_std_dev_bill_Length <- sd(chinstrapmale$"Culmen Length (mm)")
male_std_dev_bill_Length
male_std_dev_bill_depth <- sd(chinstrapmale$"Culmen Depth (mm)")
male_std_dev_bill_depth
male_std_dev_flipper_Length <- sd(chinstrapmale$"Flipper Length (mm)")
male_std_dev_flipper_Length
male_std_dev_body_mass <- sd(chinstrapmale$"Body Mass (g)")
male_std_dev_body_mass

# Standard deviation of Chinstrap Female

female_std_dev_bill_Length <- sd(chinstrapmale$"Culmen Length (mm)")
female_std_dev_bill_Length
female_std_dev_bill_depth <- sd(chinstrapmale$"Culmen Depth (mm)")
female_std_dev_bill_depth
female_std_dev_flipper_Length <- sd(chinstrapmale$"Flipper Length (mm)")
female_std_dev_flipper_Length
female_std_dev_body_mass <- sd(chinstrapmale$"Body Mass (g)")
female_std_dev_body_mass

```


```{r}
Sextable=table(df$Sex,df$Species)
Sextable
adelieSex=Sextable[,1]
gentooSex=Sextable[,3]
chinstrapSex=Sextable[,2]

```
```{r label = bird.data.preperation, echo=FALSE}
pspc = c("Aegolius funereus"
        ,"Circus pygargus"
        ,"Aquila heliaca"
        ,"Buteo galapagoensis"
        ,"Buteo ridgwayi"
        ,"Haliaeetus albicilla"
        ,"Falco columbarius"
        ,"Falco naumanni"
        ,"Falco sparverius"
        ,"Falco tinnunculus"
        ,"Accipiter cooperii"
        ,"Accipiter nisus"
        ,"Athene cunicularia"
        ,"Tyto alba"
        ,"Gyps fulvus")
# C bmm D bmf E wlm F wlf J wlsdi K bmsdi
pbmm = c(119.2051282
        ,261
        ,2585
        ,914.03
        ,315
        ,4014
        ,163
        ,141
        ,106.1520325
        ,167
        ,353.4528302
        ,150
        ,151.1702128
        ,362.0529197
        ,8132
        
)
pbmf = c(137.5798319
        ,370
        ,3845
        ,1332.940299
        ,414
        ,5572
        ,218
        ,164
        ,120.4013158
        ,201
        ,558.0681818
        ,325
        ,162.75
        ,418.5202614
        ,8525
)
pbmsdi = c(-0.06225983542
          ,-0.1515612167
          ,-0.1724357967
          ,-0.1638502479
          ,-0.1186897873
          ,-0.1424337396
          ,-0.1262688892
          ,-0.06562473539
          ,-0.05470291895
          ,-0.08047958627
          ,-0.1983557985
          ,-0.3357921019
          ,-0.03205477291
          ,-0.06294443382
          ,-0.0204970177
)

pwlm = c(167.58
        ,360
        ,566.13
        ,393.427
        ,228.1
        ,612.6
        ,197.99
        ,235.8
        ,179.95
        ,237.41
        ,232.6
        ,206.16
        ,171.9
        ,301.24
        ,721.88
)
pwlf = c(176.28
        ,367.23
        ,614.2
        ,433.966
        ,244.9
        ,667.67
        ,219.36
        ,237.33
        ,188.03
        ,249.13
        ,258
        ,243.24
        ,171.4
        ,303.01
        ,728.5
)

pwlsdi = c(-0.02198085575
          ,-0.008635651888
          ,-0.03539364276
          ,-0.04259154386
          ,-0.03086349985
          ,-0.03738487032
          ,-0.0445141818
          ,-0.002808838474
          ,-0.01907529506
          ,-0.02092702
          ,-0.04500999557
          ,-0.0718305892
          ,0.0012650591
          ,-0.002544322488
          ,-0.003964546444
)
preybird = data.frame(pspc, pbmf,pbmm,pbmsdi,pwlf,pwlm,pwlsdi)

sspc = c("Malurus amabilis"
         ,"Malurus cyaneus"
         ,"Phainopepla nitens"
         ,"Hylocichla mustelina"
         ,"Cinclus cinclus"
         ,"Cercomacra tyrannina"
         ,"Empidonax minimus"
         ,"Erithacus rubecula"
         ,"Ficedula hypoleuca"
         ,"Oenanthe oenanthe"
         ,"Phoenicurus ochruros"
         ,"Sialia mexicana"
         ,"Sitta europaea")

sbmm = c(9.1
         ,11.3
         ,20.7
         ,47.8
         ,70.86623911
         ,17.5
         ,11.1
         ,16.4
         ,12.48447205
         ,23.4411215
         ,15.1
         ,25.8
         ,19.23307692
  
)
sbmf = c(8.2
         ,10.5
         ,21
         ,52.5
         ,59.56839218
         ,16.6
         ,10.2
         ,17.1
         ,14.22006289
         ,22.71935484
         ,16.4
         ,27.1
         ,18.42967033
  
)
swlm = c(51.3
         ,52.74
         ,92.9256
         ,108.5
         ,90.46
         ,62.45
         ,64
         ,72.42
         ,78.55
         ,99.02
         ,83.26
         ,104.5
         ,84.31
  
)
swlf = c(49.73
         ,51.17
         ,90.4146
         ,104.8
         ,85.2
         ,60.3
         ,61
         ,70.75
         ,77.5
         ,95.01
         ,80.87
         ,100.5
         ,82.38
  
)
swlsdi = c(0.01349890588
           ,0.01312470849
           ,0.01189680863
           ,0.01506845554
           ,0.02601698864
           ,0.01521513057
           ,0.02085013897
           ,0.01013207628
           ,0.00584448687
           ,0.0179536039
           ,0.01264896344
           ,0.01695022869
           ,0.01005730168
  
)
sbmsdi = c(0.04522753994
           ,0.03188914441
           ,-0.006248949277
           ,-0.04073140679
           ,0.07542350713
           ,0.02292996065
           ,0.03672280702
           ,-0.01815226234
           ,-0.05653133571
           ,0.01358239127
           ,-0.03586690075
           ,-0.02134958491
           ,0.01853120196
)
songbird = data.frame(sspc,sbmf,sbmm,sbmsdi,swlf,swlm,swlsdi)

```


## Data analysis
numerical data summary adelie:
```{r}
#Important to take arithmetic mean 
meanbodymassadelie=mean(adelieset$"Body Mass (g)", na.rm=TRUE)
meanbodymassadeliemale=mean(adeliemale$"Body Mass (g)", na.rm=TRUE)
meanbodymassadeliefemale=mean(adeliefemale$"Body Mass (g)", na.rm=TRUE)
medianbodymassadeliemale=median(adeliemale$"Body Mass (g)", na.rm=TRUE)
medianbodymassadeliefemale=median(adeliefemale$"Body Mass (g)", na.rm=TRUE)

summaryadeliefemale=summary(adeliefemale[,3:6])
summaryadeliemale=summary(adeliemale[,3:6])

```

numerical data summary chinstrap bodymass
```{r}
meanbodymasschinstrap=mean(chinstrapset$"Body Mass (g)", na.rm=TRUE)
meanbodymasschinstrapmale=mean(chinstrapmale$"Body Mass (g)", na.rm=TRUE)
meanbodymasschinstrapfemale=mean(chinstrapfemale$"Body Mass (g)", na.rm=TRUE)
medianbodymasschinstrapmale=median(chinstrapmale$"Body Mass (g)", na.rm=TRUE)
medianbodymasschinstrapfemale=median(chinstrapfemale$"Body Mass (g)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```

numerical data summary chinstrap billlength 
```{r}
meanbilllengthchinstrap=mean(chinstrapset$"Culmen Length (mm)", na.rm=TRUE)
meanbilllengthchinstrapmale=mean(chinstrapmale$"Culmen Length (mm)", na.rm=TRUE)
meanbilllengthchinstrapfemale=mean(chinstrapfemale$"Culmen Length (mm)", na.rm=TRUE)
medianbilllengthchinstrapmale=median(chinstrapmale$"Culmen Length (mm)", na.rm=TRUE)
medianbilllengthchinstrapfemale=median(chinstrapfemale$"Culmen Length (mm)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```

Numerical data summary bill depth 
```{r}
meanbilldepthchinstrap=mean(chinstrapset$"Culmen Depth (mm)", na.rm=TRUE)
meanbilldepthchinstrapmale=mean(chinstrapmale$"Culmen Depth (mm)", na.rm=TRUE)
meanbilldepthchinstrapfemale=mean(chinstrapfemale$"Culmen Depth (mm)", na.rm=TRUE)
medianbilldepthchinstrapmale=median(chinstrapmale$"Culmen Depth (mm)", na.rm=TRUE)
medianbilldepthchinstrapfemale=median(chinstrapfemale$"Culmen Depth (mm)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```

numerical data summary flipperlength

```{r}
meanflipperlengthchinstrap=mean(chinstrapset$"Flipper Length (mm)", na.rm=TRUE)
meanflipperlengthchinstrapmale=mean(chinstrapmale$"Flipper Length (mm)", na.rm=TRUE)
meanflipperlengthchinstrapfemale=mean(chinstrapfemale$"Flipper Length (mm)", na.rm=TRUE)
medianflipperlengthchinstrapmale=median(chinstrapmale$"Flipper Length (mm)", na.rm=TRUE)
medianflipperlengthchinstrapfemale=median(chinstrapfemale$"Flipper Length (mm)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```
### Shapiro-wilke test
check if the data sets of the penguins satisfy the normal distribution, to use 
subsequent t-test 
```{r label = shapiro-wilke-test, echo=FALSE}
a_bill_length_female = shapiro.test(na.omit(adeliefemale$"Culmen Length (mm)"))$p.value
a_bill_length_male = shapiro.test(na.omit(adeliemale$"Culmen Length (mm)"))$p.value

a_bill_depth_female = shapiro.test(na.omit(adeliefemale$"Culmen Depth (mm)"))$p.value
a_bill_depth_male_fit = adeliemale$"Culmen Depth (mm)"[adeliemale$"Culmen Depth (mm)"<21.2]
a_bill_depth_male = shapiro.test(na.omit(a_bill_depth_male_fit))$p.value

a_flipper_length_female = shapiro.test(na.omit(adeliefemale$"Flipper Length (mm)"))$p.value
a_flipper_length_male = shapiro.test(adeliemale$"Flipper Length (mm)")$p.value

a_body_mass_female = shapiro.test(na.omit(adeliefemale$"Body Mass (g)"))$p.value
a_body_mass_male = shapiro.test(na.omit(adeliemale$"Body Mass (g)"))$p.value


adelishapiro = data.frame(a_bill_length_female,a_bill_length_male,a_bill_depth_female,a_bill_depth_male, a_flipper_length_female,a_flipper_length_male,a_body_mass_female,a_body_mass_male)

adelishapiro>0.05

c_bill_length_female_fit = chinstrapfemale$"Culmen Length (mm)"[chinstrapfemale$"Culmen Length (mm)"<58]
c_bill_length_female = shapiro.test(na.omit(c_bill_length_female_fit))$p.value
c_bill_length_male = shapiro.test(na.omit(chinstrapmale$"Culmen Length (mm)"))$p.value

c_bill_depth_female = shapiro.test(na.omit(chinstrapfemale$"Culmen Depth (mm)"))$p.value
c_bill_depth_male = shapiro.test(na.omit(chinstrapmale$"Culmen Depth (mm)"))$p.value

c_flipper_length_female = shapiro.test(na.omit(chinstrapfemale$"Flipper Length (mm)"))$p.value
c_flipper_length_male = shapiro.test(na.omit(chinstrapmale$"Flipper Length (mm)"))$p.value

c_body_mass_female = shapiro.test(na.omit(chinstrapfemale$"Body Mass (g)"))$p.value
c_body_mass_male = shapiro.test(na.omit(chinstrapmale$"Body Mass (g)"))$p.value


chinshapiro = data.frame(c_bill_length_female,c_bill_length_male,c_bill_depth_female,c_bill_depth_male, c_flipper_length_female,c_flipper_length_male,c_body_mass_female,c_body_mass_male)

chinshapiro>0.05

g_bill_length_female = shapiro.test(na.omit(gentoofemale$"Culmen Length (mm)"))$p.value
g_bill_length_male_fit = gentoomale$"Culmen Length (mm)"[gentoomale$"Culmen Length (mm)"<59]
g_bill_length_male = shapiro.test(na.omit(g_bill_length_male_fit))$p.value

g_bill_depth_female = shapiro.test(na.omit(gentoofemale$"Culmen Depth (mm)"))$p.value
g_bill_depth_male = shapiro.test(na.omit(gentoomale$"Culmen Depth (mm)"))$p.value

g_flipper_length_female = shapiro.test(na.omit(gentoofemale$"Flipper Length (mm)"))$p.value
g_flipper_length_male = shapiro.test(na.omit(gentoomale$"Flipper Length (mm)"))$p.value

g_body_mass_female = shapiro.test(na.omit(gentoofemale$"Body Mass (g)"))$p.value
g_body_mass_male = shapiro.test(na.omit(gentoomale$"Body Mass (g)"))$p.value


gentooshapiro = data.frame(g_bill_length_female,g_bill_length_male,g_bill_depth_female,g_bill_depth_male, g_flipper_length_female,g_flipper_length_male,g_body_mass_female,g_body_mass_male)

gentooshapiro>0.05
```
To satisfy a normal distribution, 1 outline in each data set bill_depth_adelie_male, bill_length_chinstrap_female and bill_length_gentoo_male were removed.

### T-test

to check if there is a statistical significant Sexual dimorphism, the t-test was used.

```{r label=t-test, echo=FALSE,results='hide'}
t.test(c_bill_length_female_fit,chinstrapmale$"Culmen Length (mm)")
t.test(chinstrapfemale$"Culmen Depth (mm)",chinstrapmale$"Culmen Depth (mm)")
t.test(chinstrapfemale$"Flipper Length (mm)",chinstrapmale$"Flipper Length (mm)")
t.test(chinstrapfemale$"Body Mass (g)",chinstrapmale$"Body Mass (g)")
```

|categories|female|male|p-value|significant difference|
|--|--:|--:|--:|:---:|
|bill length in mm|46.23|51.09|1e-13|yes|
|bill depth in mm|17.59|19.25|7e-13|yes|
|flipper length in mm|191.7|199.9|3e-07|yes|
|body mass in g|3527|3939|3e-07|yes|
  
According to the t test, there is a difference in the average body size and body mass between the female and male chinstrap groups.

### Effecsize by cohens d
The function calculates the mean of "Body Mass (g)" for males and females separately.
It then calculates the difference between these two means.
Finally, it standardizes this difference by dividing it by the pooled standard deviation of the two groups.

Output Interpretation:
The resulting Cohen's d value tells you how many standard deviations the means of the two groups (male and female) differ.
It's a measure of the effect size of the Sex difference on body mass. 
```{r}

cohen.d(chinstrapset$"Body Mass (g)", chinstrapset$Sex)
cohen.d(chinstrapset$"Culmen Length (mm)", chinstrapset$Sex)
cohen.d(chinstrapset$"Culmen Depth (mm)", chinstrapset$Sex)
cohen.d(chinstrapset$"Flipper Length (mm)", chinstrapset$Sex)
```



### The variable categorical weight of the Chinstrap:

```{r}
cWeight = cut(chinstrapset$"Body Mass (g)",breaks=quantile(chinstrapset$"Body Mass (g)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cWeight) = c("light", "medium", "heavy")

tab=addmargins(table(chinstrapset$Sex,cWeight),# specifiy the table
           FUN = sum # can also use all the other functions of Data Summary
           ) 
tab
```
```{r label = bill.length}
cblen = cut(chinstrapset$"Culmen Depth (mm)",breaks=quantile(chinstrapset$"Culmen Depth (mm)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cblen) = c("short", "medium", "long")

tab.blen=addmargins(table(chinstrapset$Sex,cblen),FUN = sum) 
tab.blen
```
```{r label = bill.depth}
cbdep = cut(chinstrapset$"Culmen Depth (mm)",breaks=quantile(chinstrapset$"Culmen Depth (mm)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cbdep) = c("deep", "medium", "shallow")

tab.bdep=addmargins(table(chinstrapset$Sex,cbdep),FUN = sum) 
tab.bdep
```
```{r label = flipper.length}
cflen = cut(chinstrapset$"Flipper Length (mm)",breaks=quantile(chinstrapset$"Flipper Length (mm)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cflen) = c("short", "medium", "long")

tab.flen=addmargins(table(chinstrapset$Sex,cflen),FUN = sum) 
tab.flen
```



```{r}
cohensH = function (tab) {pt=prop.test(tab)
h=2*abs(asin(sqrt(pt$estimate[1]))-
asin(sqrt(pt$estimate[2]))) 
return(h[[1]]) }
```

```{r}
dg.cramersV = function (tab,correct=TRUE) {t=min(dim(tab)) 
return(sqrt(chisq.test(tab,correct=correct)$statistic/
              (sum(tab)*(t-1)))[[1]])}
```


```{r}
dg.cramersV(tab)

knitr::kable(tab)
```


```{r}
tab[3,1]*tab[1,4]/tab[3,4] # this is the expected value for the number of female persons in the light category 
tab[3,2]*tab[1,4]/tab[3,4] # this is the expected value for the number of female persons in the medium category 
tab[3,3]*tab[1,4]/tab[3,4] # this is the expected value for the number of female persons in the heavy category 
```

```{r}
tab[3,1]*tab[2,4]/tab[3,4] # this is the expected value for the number of male persons in the light category 
tab[3,2]*tab[2,4]/tab[3,4] # this is the expected value for the number of male persons in the medium category 
tab[3,3]*tab[2,4]/tab[3,4] # this is the expected value for the number of male persons in the heavy category 
```
```{r}
prop.test(table(cWeight,chinstrapset$Sex))
prop.table(table(chinstrapset$Sex,cWeight))
```
### chisq-test 

we can see if the sex of chinstrap is actually related to the body mass of penguins.

### data preperation

```{r label = chi.bodymass}

cat.f.bodymass = c(18,12,4)
cat.m.bodymass = c(5,10,19)
chi.dat.bodymass = data.frame(cat.f.bodymass,cat.m.bodymass)
pval.chi.bodymass = chisq.test(chi.dat.bodymass)$p.value
```
```{r label = chi.bill.length}

cat.f.blen = c(25,8,1)
cat.m.blen = c(1,14,19)
chi.dat.blen = data.frame(cat.f.blen,cat.m.blen)
pval.chi.blen = chisq.test(chi.dat.blen)$p.value
```
```{r label = chi.bill.depth}

cat.f.bdep = c(25,8,1)
cat.m.bdep = c(1,14,19)
chi.dat.bdep = data.frame(cat.f.bdep,cat.m.bdep)
pval.chi.bdep = chisq.test(chi.dat.bdep)$p.value
```
```{r label = chi.flipper.length}

cat.f.flen = c(20,10,4)
cat.m.flen = c(5,11,18)
chi.dat.flen = data.frame(cat.f.flen,cat.m.flen)
pval.chi.flen = chisq.test(chi.dat.flen)$p.value
```

We categoriz chinstrap penguins data, which are bill length, bill depth, flipper length, and body mass into three part based on their size. Through a chi-square independence test, we confirm that sex is associated with bodysize and body mass in the chinstrap penguin population.
```{r}
p.values = c(pval.chi.blen,pval.chi.bdep,pval.chi.flen,pval.chi.bodymass)
significant = c('yes','yes','yes','yes')
chi.result = data.frame(p.values,significant)
chi.result
```

### Calculating SDI 

Calculating SDI of measurements of penguin species.

Morphological measurements taken for all penguin individuals included culmen length (mm), culmen depth (mm), flipper length (mm) and body mass (g).

To estimate overall SSD, a sexual dimorphism index (SDI) was first calculated for each of the seven morphological measurements taken. The SDI was calculated as: [(larger sex/smaller sex) − 1], arbitrarily set to positive when males are larger and negative when females are larger (Lovich & Gibbons, 1992). SSD was then calculated for all male-female.


```{r label = calculate.SDI.chinstrap}
sdi.chinstrap.blen = meanbilllengthchinstrapmale / meanbilllengthchinstrapfemale - 1
sdi.chinstrap.bdep = meanbilldepthchinstrapmale / meanbilldepthchinstrapfemale - 1
sdi.chinstrap.flen = meanflipperlengthchinstrapmale / meanflipperlengthchinstrapfemale - 1
sdi.chinstrap.bmass = meanbodymasschinstrapmale / meanbodymasschinstrapfemale - 1
```
```{r label = calculate.SDI.adelie}
sdi.adeli.blen = meanbilllengthadeliemale / meanbilllengthadeliefemale - 1
sdi.adeli.bdep = meanbilldepthadeliemale / meanbilldepthadeliefemale - 1
sdi.adeli.flen = meanflipperlengthadeliemale / meanflipperlengthadeliefemale -1
sdi.adeli.bmass = meanbodymassadeliemale / meanbodymassadeliefemale-1
```
```{r label = calculate.SDI.gentoo}
sdi.gentoo.blen = meanbilllengthgentoomale / meanbilllengthgentoofemale - 1
sdi.gentoo.bdep = meanbilldepthgentoomale / meanbilldepthgentoofemale - 1
sdi.gentoo.flen = meanflipperlengthgentoomale / meanflipperlengthgentoofemale - 1
sdi.gentoo.bmass = meanbodymassgentoomale / meanbodymassgentoofemale - 1
```

```{r label = preparing.SDI.table}
spc=c("Chinstrap", "Adelie", "Gentoo")
bmass.f = c(meanbodymasschinstrapfemale,meanbodymassadeliefemale,meanbodymassgentoofemale)
bmass.m = c(meanbodymasschinstrapmale,meanbodymassadeliemale,meanbodymassgentoomale)
bmass.sdi = c(sdi.chinstrap.bmass,sdi.adeli.bmass,sdi.gentoo.bmass)

blen.f = c(meanbilllengthchinstrapfemale,meanbilllengthadeliefemale,meanbilllengthgentoofemale)
blen.m = c(meanbilllengthchinstrapmale,meanbilllengthadeliemale,meanbilllengthgentoomale)
blen.sdi = c(sdi.chinstrap.blen,sdi.adeli.blen,sdi.gentoo.blen)

bdep.f = c(meanbilldepthchinstrapfemale,meanbilldepthadeliefemale,meanbilllengthgentoofemale)
bdep.m = c(meanbilldepthchinstrapmale,meanbilldepthadeliemale,meanbilldepthgentoomale)
bdep.sdi = c(sdi.chinstrap.bdep,sdi.adeli.bdep,sdi.gentoo.bdep)

flen.f = c(meanflipperlengthchinstrapfemale,meanflipperlengthadeliefemale,meanflipperlengthgentoofemale)
flen.m = c(meanflipperlengthchinstrapmale,meanflipperlengthadeliemale,meanflipperlengthgentoomale)
flen.sdi = c(sdi.chinstrap.flen,sdi.adeli.flen,sdi.gentoo.flen)
sdi.table = data.frame(spc,bmass.f, bmass.m, bmass.sdi, blen.f, blen.m, blen.sdi, bdep.f, bdep.m, bdep.sdi, flen.f, flen.m, flen.sdi)
sdi.table
```

### expression with table

```{r}
penspc = c("Pygoscelis antarctica", "Pygoscelis adeliae", "Pygoscelis papua")
bspc = c(penspc,pspc,sspc)
bmf = c(bmass.f,pbmf,sbmf)
bmm = c(bmass.m,pbmm,sbmm)
bmsdi = c(bmass.sdi,pbmsdi,sbmsdi)
wlf = c(flen.f,pwlf,swlf)
wlm = c(flen.m,pwlm,swlm)
wlsdi = c(flen.sdi,pwlsdi,swlsdi)
bias = c("Male biased","Male biased","Male biased","Female biased","Female biased",
         "Female biased","Female biased","Female biased","Female biased","Female biased",
         "Female biased","Female biased","Female biased","Female biased","Female biased",
         "Male biased","Female biased","Female biased","Male biased","Male biased",
         "Male biased","Male biased","Male biased","Male biased","Male biased","Male biased",
         "Male biased","Male biased","Male biased","Male biased","Male biased")
bird = data.frame(bspc,bmf,bmm,bmsdi,wlf,wlm,wlsdi,bias)
```

```{r, result="asis"}
kable(sdi.table, col.names=c('Species',"BM F","BM M","BM SDI","BL F","BL M","BL SDI", "BD F","BD M", "BD SDI", "FL F","FL M","FL SDI"),
      digits = 3,valign='t',
      caption="Table of measurements and SDI value of penguin species")
```

BM, BL, BD and FL stand for body mass, bill length, bill depth and filpper length respectively.

### Comparison with other bird species

The data for different avian species were sourced from the database provided by Valcu, M., Valcu, C., & Kempenaers, B. (2023). This dataset encompasses information on body mass, wing length, and Sexual Dimorphism Index (SDI) categorized by male and female specimens for various avian species.
Given that the database includes statistical values for wing length and body mass, we can compare these metrics with the corresponding flipper length and body mass of the penguins in our dataset. This enables a meaningful assessment of the morphological sexual dimorphism of penguins in relation to the broader avian species data provided.

```{r label=comparison.bird.sdi,results='asis'}
kable(bird, col.names = c('Species','BM F', 'BM M', 'BM SDI', 'WL or FL F','WL or FL M','WL or FL SDI','Bias'),
      digits = 3, valign='t')
```


## Plots:

### Stripcharts for Adelie 

Stripcharts for all the attributes

```{r}
stripchart(chinstrapset$"Body Mass (g)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))
stripchart(chinstrapset$"Culmen Length (mm)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))
stripchart(chinstrapset$"Flipper Length (mm)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))
stripchart(chinstrapset$"Culmen Depth (mm)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))

```


### Stripcharts for Chinstrap

### Histograms bodyweight

```{r echo=FALSE}

## Summary statistics
xy <- summary(adeliemale$"Body Mass (g)")



# Create a histogram
hist(adeliemale$"Body Mass (g)",
     main = "Histogram of Body Mass of Male Adelie Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(3000,5000),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(adeliemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymassadeliemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymassadeliemale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymassadeliefemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymassadeliefemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```



```{r echo=FALSE}
## Summary statistics
yx <- summary(adeliefemale$"Body Mass (g)")



# Create a histogram
hist(adeliefemale$"Body Mass (g)",
     main = "Histogram of Body Mass of Female Adelie Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(2500,4500),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(adeliefemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymassadeliefemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymassadeliefemale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymassadeliemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymassadeliemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```



### Histogramm Bill length Chinstrap


## Bodymass Chinstrap


```{r echo=FALSE}
## Summary statistics
yx <- summary(chinstrapmale$"Body Mass (g)")



# Create a histogram
hist(chinstrapmale$"Body Mass (g)",
     main = "Histogram of Body Mass of Male Chinstrap Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(2500,5000),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymasschinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymasschinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymasschinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male","Mean female", "Median female" ), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```

```{r echo=FALSE}
## Summary statistics
yx <- summary(chinstrapfemale$"Body Mass (g)")



# Create a histogram
hist(chinstrapfemale$"Body Mass (g)",
     main = "Histogram of Body Mass of Female Chinstrap Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(2500,5000),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymasschinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymasschinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```


```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))

## Summary statistics for male
yx_male <- summary(chinstrapmale$"Body Mass (g)")

# Histogram for male chinstrap penguins
hist(chinstrapmale$"Body Mass (g)",
     main = "",
     xlab = "Body Mass (g)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(2500, 5000),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanbodymasschinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 2)

## Summary statistics for female
yx_female <- summary(chinstrapfemale$"Body Mass (g)")

# Histogram for female chinstrap penguins
hist(chinstrapfemale$"Body Mass (g)",
     main = "",
     xlab = "Body Mass (g)",
     ylab = "",
     col = "lightpink",
     xlim = c(2500, 5000),
     freq = FALSE)

# Add density line for female
lines(density(chinstrapfemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanbodymasschinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapfemale, col = "blue", lwd = 2, lty = 2)
# Add a common main title and a legend
mtext("Bill Length of Male and Female Chinstrap Penguins", side = 3, line = 2, outer = TRUE)
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)

# Reset par to default
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))

# Since we cannot have two legends for the shared elements, we mention these in the caption.







### Histogramm Bill length Chinstrap

```








```{r echo=FALSE}




# Create a histogram
hist(chinstrapmale$"Culmen Length (mm)",
 
     main = "Histogram of Bill Length of Male Chinstrap Penguins",
     xlab = "Bill length Distribution in mm",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1,2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(40,60),
     
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilllengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilllengthchinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilllengthchinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```


```{r echo=FALSE}




# Create a histogram
hist(chinstrapfemale$"Culmen Length (mm)",
     main = "Histogram of Bill Length of Female Chinstrap Penguins",
     xlab = "Bill length Distribution in mm",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(40,60),
     ylim= c(0.0,0.3),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilllengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilllengthchinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```

```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(4, 4, 2, 1), oma = c(2, 2, 2, 1))

# Histogram for male chinstrap penguins' bill length
hist(chinstrapmale$"Culmen Length (mm)",
     main = "",
     xlab = "Bill Length (mm)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(40, 60),
     ylim = c(0.0, 0.3),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanbilllengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 2)

# Histogram for female chinstrap penguins' bill length
hist(chinstrapfemale$"Culmen Length (mm)",
     main = "",
     xlab = "Bill Length (mm)",
     ylab = "",
     col = "lightpink",
     xlim = c(40, 60),
     ylim = c(0.0, 0.3),
     freq = FALSE)

# Add density line for female
lines(density(chinstrapfemale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanbilllengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapfemale, col = "blue", lwd = 2, lty = 2)

# Add a common main title and a legend
mtext("Bill Length of Male and Female Chinstrap Penguins", side = 3, line = 2, outer = TRUE)
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)


# Reset par to default for further plots
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))




```


### Histogram bill depth 
```{r echo=FALSE}




# Create a histogram
hist(chinstrapmale$"Culmen Depth (mm)",
   
     main = "Histogram of Bill Depth of Male Chinstrap Penguins",
     xlab = "Bill depth Distribution in mm",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1,2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(15,22),
     
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilldepthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilldepthchinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilldepthchinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```


```{r echo=FALSE}




# Create a histogram
hist(chinstrapfemale$"Culmen Depth (mm)",
     main = "Histogram of Bill depth of Female Chinstrap Penguins",
     xlab = "Bill depth Distribution in mm",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(15,22),
     ylim= c(0.0,0.6),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilldepthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilldepthchinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```

```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(4, 4, 2, 1), oma = c(2, 2, 2, 1))

# Histogram for male chinstrap penguins' bill depth
hist(chinstrapmale$"Culmen Depth (mm)",
     main = "",
     xlab = "Bill Depth (mm)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(15, 22),
     ylim= c(0.0, 0.6),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanbilldepthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 2)

# Histogram for female chinstrap penguins' bill depth
hist(chinstrapfemale$"Culmen Depth (mm)",
     main = "",
     xlab = "Bill Depth (mm)",
     ylab = "",
     col = "lightpink",
     xlim = c(15, 22),
     ylim= c(0.0, 0.6),
     freq = FALSE)


# Add density line for female
lines(density(chinstrapfemale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanbilldepthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapfemale, col = "blue", lwd = 2, lty = 2)

# Add a common main title above the plots
mtext("Bill Depth of Male and Female Chinstrap Penguins", side = 3, line = 1, outer = TRUE)

# Since we have a shared title, we remove the individual main titles by setting `main = ""` in the `hist` functions.

# Add a shared legend below the plots
# Add legend
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)


# Reset par to default for further plots
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))


```


## Histogram flipperlength
```{r echo=FALSE}




# Create a histogram
hist(chinstrapmale$"Flipper Length (mm)",
   
     main = "Histogram of Flipper Length of Male Chinstrap Penguins",
     xlab = "Flipper Length Distribution in mm",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1,2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(170,220),
     
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanflipperlengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanflipperlengthchinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianflipperlengthchinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```


```{r echo=FALSE}




# Create a histogram
hist(chinstrapfemale$"Flipper Length (mm)",
     main = "Histogram of Flipper length of Female Chinstrap Penguins",
     xlab = "Flipper Length Distribution in mm",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(170,220),
     #ylim= c(0.0,0.6),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanflipperlengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanflipperlengthchinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```


```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(5, 4, 4, 2) + 0.1, oma = c(0, 0, 2, 0))

# Histogram for male chinstrap penguins' flipper length
hist(chinstrapmale$"Flipper Length (mm)",
     main = "",
     xlab = "Flipper Length (mm)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(170, 220),
     ylim= c(0, 0.08),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanflipperlengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 2)

# Histogram for female chinstrap penguins' flipper length
hist(chinstrapfemale$"Flipper Length (mm)",
     main = "",
     xlab = "Flipper Length (mm)",
     ylab = "",
     col = "lightpink",
     xlim = c(170, 220),
     ylim= c(0, 0.08),
     freq = FALSE)

# Add density line for female
lines(density(chinstrapfemale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanflipperlengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapfemale, col = "blue", lwd = 2, lty = 2)

# Add a common main title and a legend
mtext("Histogram of Flipper Length of Chinstrap Penguins", side = 3, line = 1, outer = TRUE)
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)

# Reset par to default for further plots
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))


```




