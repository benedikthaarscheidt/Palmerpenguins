---
title: Sexual dimorphism in Chinstrap penguins"
author: "Benedikt Haarscheidt, Jaesub Kim, Ahmed Tijani Akinfalabi "
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_depth: 5
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '5'
---
```{r echo=FALSE, include=FALSE}

library(palmerpenguins)
library(datasets)
library(MASS)
library(effsize)
library(DAAG)
library(palmerpenguins)
```

This is the mammals dataset containing body and brain weigth of 62 land Species
```{r}
data(mammals)
head(mammals)


```
This is the possum datase containing measurments of possums in australia 
```{r}
data(possum)
head(possum)
```



```{r}
data(penguins_raw)
head(penguins_raw)
```


## Data preparation

Subsetting the penguin Species 
```{r}
head(penguins)
df=penguins_raw
adelieset <- df[df$Species == "Adelie Penguin (Pygoscelis adeliae)", ]
adeliemale =adelieset[adelieset$Sex == "MALE",]
adeliefemale = adelieset[adelieset$Sex =="FEMALE",]

gentooset=df[df$Species =="Gentoo penguin (Pygoscelis papua)",]
gentoomale = gentooset[gentooset$Sex =="MALE",]
gentoofemale = gentooset[gentooset$Sex =="FEMALE",]

chinstrapset=df[df$Species =="Chinstrap penguin (Pygoscelis antarctica)",]
chinstrapmale=chinstrapset[chinstrapset$Sex =="MALE",]
chinstrapfemale=chinstrapset[chinstrapset$Sex =="FEMALE",]

head(chinstrapmale)
head(chinstrapfemale)


# Standard deviation of Chinstrap Male

male_std_dev_bill_Length <- sd(chinstrapmale$"Culmen Length (mm)")
male_std_dev_bill_Length
male_std_dev_bill_depth <- sd(chinstrapmale$"Culmen Depth (mm)")
male_std_dev_bill_depth
male_std_dev_flipper_Length <- sd(chinstrapmale$"Flipper Length (mm)")
male_std_dev_flipper_Length
male_std_dev_body_mass <- sd(chinstrapmale$"Body Mass (g)")
male_std_dev_body_mass

# Standard deviation of Chinstrap Female

female_std_dev_bill_Length <- sd(chinstrapmale$"Culmen Length (mm)")
female_std_dev_bill_Length
female_std_dev_bill_depth <- sd(chinstrapmale$"Culmen Depth (mm)")
female_std_dev_bill_depth
female_std_dev_flipper_Length <- sd(chinstrapmale$"Flipper Length (mm)")
female_std_dev_flipper_Length
female_std_dev_body_mass <- sd(chinstrapmale$"Body Mass (g)")
female_std_dev_body_mass

```


```{r}
Sextable=table(df$Sex,df$Species)
Sextable
adelieSex=Sextable[,1]
gentooSex=Sextable[,3]
chinstrapSex=Sextable[,2]

```



## Data analysis
numerical data summary adelie:
```{r}
#Important to take arithmetic mean 
meanbodymassadelie=mean(adelieset$"Body Mass (g)", na.rm=TRUE)
meanbodymassadeliemale=mean(adeliemale$"Body Mass (g)", na.rm=TRUE)
meanbodymassadeliefemale=mean(adeliefemale$"Body Mass (g)", na.rm=TRUE)
medianbodymassadeliemale=median(adeliemale$"Body Mass (g)", na.rm=TRUE)
medianbodymassadeliefemale=median(adeliefemale$"Body Mass (g)", na.rm=TRUE)

summaryadeliefemale=summary(adeliefemale[,3:6])
summaryadeliemale=summary(adeliemale[,3:6])

```

numerical data summary chinstrap bodymass
```{r}
meanbodymasschinstrap=mean(chinstrapset$"Body Mass (g)", na.rm=TRUE)
meanbodymasschinstrapmale=mean(chinstrapmale$"Body Mass (g)", na.rm=TRUE)
meanbodymasschinstrapfemale=mean(chinstrapfemale$"Body Mass (g)", na.rm=TRUE)
medianbodymasschinstrapmale=median(chinstrapmale$"Body Mass (g)", na.rm=TRUE)
medianbodymasschinstrapfemale=median(chinstrapfemale$"Body Mass (g)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```

numerical data summary chinstrap billlength 
```{r}
meanbilllengthchinstrap=mean(chinstrapset$"Culmen Length (mm)", na.rm=TRUE)
meanbilllengthchinstrapmale=mean(chinstrapmale$"Culmen Length (mm)", na.rm=TRUE)
meanbilllengthchinstrapfemale=mean(chinstrapfemale$"Culmen Length (mm)", na.rm=TRUE)
medianbilllengthchinstrapmale=median(chinstrapmale$"Culmen Length (mm)", na.rm=TRUE)
medianbilllengthchinstrapfemale=median(chinstrapfemale$"Culmen Length (mm)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```

Numerical data summary bill depth 
```{r}
meanbilldepthchinstrap=mean(chinstrapset$"Culmen Depth (mm)", na.rm=TRUE)
meanbilldepthchinstrapmale=mean(chinstrapmale$"Culmen Depth (mm)", na.rm=TRUE)
meanbilldepthchinstrapfemale=mean(chinstrapfemale$"Culmen Depth (mm)", na.rm=TRUE)
medianbilldepthchinstrapmale=median(chinstrapmale$"Culmen Depth (mm)", na.rm=TRUE)
medianbilldepthchinstrapfemale=median(chinstrapfemale$"Culmen Depth (mm)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```

numerical data summary flipperlength

```{r}
meanflipperlengthchinstrap=mean(chinstrapset$"Flipper Length (mm)", na.rm=TRUE)
meanflipperlengthchinstrapmale=mean(chinstrapmale$"Flipper Length (mm)", na.rm=TRUE)
meanflipperlengthchinstrapfemale=mean(chinstrapfemale$"Flipper Length (mm)", na.rm=TRUE)
medianflipperlengthchinstrapmale=median(chinstrapmale$"Flipper Length (mm)", na.rm=TRUE)
medianflipperlengthchinstrapfemale=median(chinstrapfemale$"Flipper Length (mm)", na.rm=TRUE)

summarychinstrapfemale=summary(chinstrapfemale[,3:6])
summarychinstrapmale=summary(chinstrapmale[,3:6])
```
### Shapiro-wilke test
check if the data sets of the penguins satisfy the normal distribution, to use 
subsequent t-test 
```{r label = shapiro-wilke-test, echo=FALSE}
a_bill_length_female = shapiro.test(na.omit(adeliefemale$"Culmen Length (mm)"))$p.value
a_bill_length_male = shapiro.test(na.omit(adeliemale$"Culmen Length (mm)"))$p.value

a_bill_depth_female = shapiro.test(na.omit(adeliefemale$"Culmen Depth (mm)"))$p.value
a_bill_depth_male_fit = adeliemale$"Culmen Depth (mm)"[adeliemale$"Culmen Depth (mm)"<21.2]
a_bill_depth_male = shapiro.test(na.omit(a_bill_depth_male_fit))$p.value

a_flipper_length_female = shapiro.test(na.omit(adeliefemale$"Flipper Length (mm)"))$p.value
a_flipper_length_male = shapiro.test(adeliemale$"Flipper Length (mm)")$p.value

a_body_mass_female = shapiro.test(na.omit(adeliefemale$"Body Mass (g)"))$p.value
a_body_mass_male = shapiro.test(na.omit(adeliemale$"Body Mass (g)"))$p.value


adelishapiro = data.frame(a_bill_length_female,a_bill_length_male,a_bill_depth_female,a_bill_depth_male, a_flipper_length_female,a_flipper_length_male,a_body_mass_female,a_body_mass_male)

adelishapiro>0.05

c_bill_length_female_fit = chinstrapfemale$"Culmen Length (mm)"[chinstrapfemale$"Culmen Length (mm)"<58]
c_bill_length_female = shapiro.test(na.omit(c_bill_length_female_fit))$p.value
c_bill_length_male = shapiro.test(na.omit(chinstrapmale$"Culmen Length (mm)"))$p.value

c_bill_depth_female = shapiro.test(na.omit(chinstrapfemale$"Culmen Depth (mm)"))$p.value
c_bill_depth_male = shapiro.test(na.omit(chinstrapmale$"Culmen Depth (mm)"))$p.value

c_flipper_length_female = shapiro.test(na.omit(chinstrapfemale$"Flipper Length (mm)"))$p.value
c_flipper_length_male = shapiro.test(na.omit(chinstrapmale$"Flipper Length (mm)"))$p.value

c_body_mass_female = shapiro.test(na.omit(chinstrapfemale$"Body Mass (g)"))$p.value
c_body_mass_male = shapiro.test(na.omit(chinstrapmale$"Body Mass (g)"))$p.value


chinshapiro = data.frame(c_bill_length_female,c_bill_length_male,c_bill_depth_female,c_bill_depth_male, c_flipper_length_female,c_flipper_length_male,c_body_mass_female,c_body_mass_male)

chinshapiro>0.05

g_bill_length_female = shapiro.test(na.omit(gentoofemale$"Culmen Length (mm)"))$p.value
g_bill_length_male_fit = gentoomale$"Culmen Length (mm)"[gentoomale$"Culmen Length (mm)"<59]
g_bill_length_male = shapiro.test(na.omit(g_bill_length_male_fit))$p.value

g_bill_depth_female = shapiro.test(na.omit(gentoofemale$"Culmen Depth (mm)"))$p.value
g_bill_depth_male = shapiro.test(na.omit(gentoomale$"Culmen Depth (mm)"))$p.value

g_flipper_length_female = shapiro.test(na.omit(gentoofemale$"Flipper Length (mm)"))$p.value
g_flipper_length_male = shapiro.test(na.omit(gentoomale$"Flipper Length (mm)"))$p.value

g_body_mass_female = shapiro.test(na.omit(gentoofemale$"Body Mass (g)"))$p.value
g_body_mass_male = shapiro.test(na.omit(gentoomale$"Body Mass (g)"))$p.value


gentooshapiro = data.frame(g_bill_length_female,g_bill_length_male,g_bill_depth_female,g_bill_depth_male, g_flipper_length_female,g_flipper_length_male,g_body_mass_female,g_body_mass_male)

gentooshapiro>0.05
```
To satisfy a normal distribution, 1 outline in each data set bill_depth_adelie_male, bill_length_chinstrap_female and bill_length_gentoo_male were removed.

### T-test

to check if there is a statistical significant Sexual dimorphism, the t-test was used.

```{r label=t-test, echo=FALSE,results='hide'}
t.test(c_bill_length_female_fit,chinstrapmale$"Culmen Length (mm)")
t.test(chinstrapfemale$"Culmen Depth (mm)",chinstrapmale$"Culmen Depth (mm)")
t.test(chinstrapfemale$"Flipper Length (mm)",chinstrapmale$"Flipper Length (mm)")
t.test(chinstrapfemale$"Body Mass (g)",chinstrapmale$"Body Mass (g)")
```

|categories|female|male|p-value|significant difference|
|--|--:|--:|--:|:---:|
|bill length in mm|46.23|51.09|1e-13|yes|
|bill depth in mm|17.59|19.25|7e-13|yes|
|flipper length in mm|191.7|199.9|3e-07|yes|
|body mass in g|3527|3939|3e-07|yes|
  
According to the t test, there is a difference in the average body size and body mass between the female and male chinstrap groups.

## Effecsize by cohens d
The function calculates the mean of "Body Mass (g)" for males and females separately.
It then calculates the difference between these two means.
Finally, it standardizes this difference by dividing it by the pooled standard deviation of the two groups.

Output Interpretation:
The resulting Cohen's d value tells you how many standard deviations the means of the two groups (male and female) differ.
It's a measure of the effect size of the Sex difference on body mass. 
```{r}

cohen.d(chinstrapset$"Body Mass (g)", chinstrapset$Sex)
cohen.d(chinstrapset$"Culmen Length (mm)", chinstrapset$Sex)
cohen.d(chinstrapset$"Culmen Depth (mm)", chinstrapset$Sex)
cohen.d(chinstrapset$"Flipper Length (mm)", chinstrapset$Sex)
```
# chinstrap

## Datasummary numerical
```{r}
meanbodychinstrapmale=mean(adelieset$"Body Mass (g)", na.rm=TRUE)
meanbodychinstrapfemale=mean(adeliemale$"Body Mass (g)", na.rm=TRUE)
meanbodymassadeliefemale=mean(adeliefemale$"Body Mass (g)", na.rm=TRUE)
medianbodymassadeliemale=median(adeliemale$"Body Mass (g)", na.rm=TRUE)
medianbodymassadeliefemale=median(adeliefemale$"Body Mass (g)", na.rm=TRUE)

summaryadeliefemale=summary(adeliefemale[,3:6])
summaryadeliemale=summary(adeliemale[,3:6])

```


## The variable categorical weight of the Chinstrap:

```{r}
cWeight = cut(chinstrapset$"Body Mass (g)",breaks=quantile(chinstrapset$"Body Mass (g)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cWeight) = c("light", "medium", "heavy")

tab=addmargins(table(chinstrapset$Sex,cWeight),# specifiy the table
           FUN = sum # can also use all the other functions of Data Summary
           ) 
tab
```
```{r label = bill.length}
cblen = cut(chinstrapset$"Culmen Depth (mm)",breaks=quantile(chinstrapset$"Culmen Depth (mm)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cblen) = c("short", "medium", "long")

tab.blen=addmargins(table(chinstrapset$Sex,cblen),FUN = sum) 
tab.blen
```
```{r label = bill.depth}
cbdep = cut(chinstrapset$"Culmen Depth (mm)",breaks=quantile(chinstrapset$"Culmen Depth (mm)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cbdep) = c("deep", "medium", "shallow")

tab.bdep=addmargins(table(chinstrapset$Sex,cbdep),FUN = sum) 
tab.bdep
```
```{r label = flipper.length}
cflen = cut(chinstrapset$"Flipper Length (mm)",breaks=quantile(chinstrapset$"Flipper Length (mm)",c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)

levels(cflen) = c("short", "medium", "long")

tab.flen=addmargins(table(chinstrapset$Sex,cflen),FUN = sum) 
tab.flen
```



```{r}
cohensH = function (tab) {pt=prop.test(tab)
h=2*abs(asin(sqrt(pt$estimate[1]))-
asin(sqrt(pt$estimate[2]))) 
return(h[[1]]) }
```

```{r}
dg.cramersV = function (tab,correct=TRUE) {t=min(dim(tab)) 
return(sqrt(chisq.test(tab,correct=correct)$statistic/
              (sum(tab)*(t-1)))[[1]])}
```


```{r}
dg.cramersV(tab)

knitr::kable(tab)
```


```{r}
tab[3,1]*tab[1,4]/tab[3,4] # this is the expected value for the number of female persons in the light category 
tab[3,2]*tab[1,4]/tab[3,4] # this is the expected value for the number of female persons in the medium category 
tab[3,3]*tab[1,4]/tab[3,4] # this is the expected value for the number of female persons in the heavy category 
```

```{r}
tab[3,1]*tab[2,4]/tab[3,4] # this is the expected value for the number of male persons in the light category 
tab[3,2]*tab[2,4]/tab[3,4] # this is the expected value for the number of male persons in the medium category 
tab[3,3]*tab[2,4]/tab[3,4] # this is the expected value for the number of male persons in the heavy category 
```
```{r}
prop.test(table(cWeight,chinstrapset$Sex))
prop.table(table(chinstrapset$Sex,cWeight))
```
## chisq-test 
we can see if the sex of chinstrap is actually related to the body mass of penguins.
### data preperation

```{r label = chi.bodymass}

cat.f.bodymass = c(18,12,4)
cat.m.bodymass = c(5,10,19)
chi.dat.bodymass = data.frame(cat.f.bodymass,cat.m.bodymass)
pval.chi.bodymass = chisq.test(chi.dat.bodymass)$p.value
```
```{r label = chi.bill.length}

cat.f.blen = c(25,8,1)
cat.m.blen = c(1,14,19)
chi.dat.blen = data.frame(cat.f.blen,cat.m.blen)
pval.chi.blen = chisq.test(chi.dat.blen)$p.value
```
```{r label = chi.bill.depth}

cat.f.bdep = c(25,8,1)
cat.m.bdep = c(1,14,19)
chi.dat.bdep = data.frame(cat.f.bdep,cat.m.bdep)
pval.chi.bdep = chisq.test(chi.dat.bdep)$p.value
```
```{r label = chi.flipper.length}

cat.f.flen = c(20,10,4)
cat.m.flen = c(5,11,18)
chi.dat.flen = data.frame(cat.f.flen,cat.m.flen)
pval.chi.flen = chisq.test(chi.dat.flen)$p.value
```

We categoriz chinstrap penguins data, which are bill length, bill depth, flipper length, and body mass into three part based on their size. Through a chi-square independence test, we confirm that sex is associated with bodysize and body mass in the chinstrap penguin population.
```{r}
p.values = c(pval.chi.blen,pval.chi.bdep,pval.chi.flen,pval.chi.bodymass)
significant = c('yes','yes','yes','yes')
chi.result = data.frame(p.values,significant)
chi.result
```


## Plots:

### Stripcharts for Adelie 

Stripcharts for all the attributes

```{r}
stripchart(chinstrapset$"Body Mass (g)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))
stripchart(chinstrapset$"Culmen Length (mm)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))
stripchart(chinstrapset$"Flipper Length (mm)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))
stripchart(chinstrapset$"Culmen Depth (mm)"~chinstrapset$Sex, main="Massdistribution between the biological Sexes",method="stack", col=c(2,4))

```


### Stripcharts for Chinstrap

### Histograms bodyweight

```{r echo=FALSE}

## Summary statistics
xy <- summary(adeliemale$"Body Mass (g)")



# Create a histogram
hist(adeliemale$"Body Mass (g)",
     main = "Histogram of Body Mass of Male Adelie Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(3000,5000),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(adeliemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymassadeliemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymassadeliemale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymassadeliefemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymassadeliefemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```



```{r echo=FALSE}
## Summary statistics
yx <- summary(adeliefemale$"Body Mass (g)")



# Create a histogram
hist(adeliefemale$"Body Mass (g)",
     main = "Histogram of Body Mass of Female Adelie Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(2500,4500),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(adeliefemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymassadeliefemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymassadeliefemale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymassadeliemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymassadeliemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```

<<<<<<< HEAD

### Histogramm Bill length Chinstrap

=======
## Bodymass Chinstrap
>>>>>>> c45013042169c612d17762b8d446fcb4f45e1c96

```{r echo=FALSE}
## Summary statistics
yx <- summary(chinstrapmale$"Body Mass (g)")



# Create a histogram
hist(chinstrapmale$"Body Mass (g)",
     main = "Histogram of Body Mass of Male Chinstrap Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(2500,5000),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymasschinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymasschinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymasschinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male","Mean female", "Median female" ), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```

```{r echo=FALSE}
## Summary statistics
yx <- summary(chinstrapfemale$"Body Mass (g)")



# Create a histogram
hist(chinstrapfemale$"Body Mass (g)",
     main = "Histogram of Body Mass of Female Chinstrap Penguins",
     xlab = "Body Mass Distribution in gram",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(2500,5000),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbodymasschinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbodymasschinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```


```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))

## Summary statistics for male
yx_male <- summary(chinstrapmale$"Body Mass (g)")

# Histogram for male chinstrap penguins
hist(chinstrapmale$"Body Mass (g)",
     main = "",
     xlab = "Body Mass (g)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(2500, 5000),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanbodymasschinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapmale, col = "blue", lwd = 2, lty = 2)

## Summary statistics for female
yx_female <- summary(chinstrapfemale$"Body Mass (g)")

# Histogram for female chinstrap penguins
hist(chinstrapfemale$"Body Mass (g)",
     main = "",
     xlab = "Body Mass (g)",
     ylab = "",
     col = "lightpink",
     xlim = c(2500, 5000),
     freq = FALSE)

# Add density line for female
lines(density(chinstrapfemale$"Body Mass (g)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanbodymasschinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbodymasschinstrapfemale, col = "blue", lwd = 2, lty = 2)
# Add a common main title and a legend
mtext("Bill Length of Male and Female Chinstrap Penguins", side = 3, line = 2, outer = TRUE)
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)

# Reset par to default
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))

# Since we cannot have two legends for the shared elements, we mention these in the caption.







### Histogramm Bill length Chinstrap

```








```{r echo=FALSE}




# Create a histogram
hist(chinstrapmale$"Culmen Length (mm)",
 
     main = "Histogram of Bill Length of Male Chinstrap Penguins",
     xlab = "Bill length Distribution in mm",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1,2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(40,60),
     
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilllengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilllengthchinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilllengthchinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```


```{r echo=FALSE}




# Create a histogram
hist(chinstrapfemale$"Culmen Length (mm)",
     main = "Histogram of Bill Length of Female Chinstrap Penguins",
     xlab = "Bill length Distribution in mm",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(40,60),
     ylim= c(0.0,0.3),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilllengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilllengthchinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```

```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(4, 4, 2, 1), oma = c(2, 2, 2, 1))

# Histogram for male chinstrap penguins' bill length
hist(chinstrapmale$"Culmen Length (mm)",
     main = "",
     xlab = "Bill Length (mm)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(40, 60),
     ylim = c(0.0, 0.3),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanbilllengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapmale, col = "blue", lwd = 2, lty = 2)

# Histogram for female chinstrap penguins' bill length
hist(chinstrapfemale$"Culmen Length (mm)",
     main = "",
     xlab = "Bill Length (mm)",
     ylab = "",
     col = "lightpink",
     xlim = c(40, 60),
     ylim = c(0.0, 0.3),
     freq = FALSE)

# Add density line for female
lines(density(chinstrapfemale$"Culmen Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanbilllengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilllengthchinstrapfemale, col = "blue", lwd = 2, lty = 2)

# Add a common main title and a legend
mtext("Bill Length of Male and Female Chinstrap Penguins", side = 3, line = 2, outer = TRUE)
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)


# Reset par to default for further plots
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))




```


### Histogram bill depth 
```{r echo=FALSE}




# Create a histogram
hist(chinstrapmale$"Culmen Depth (mm)",
   
     main = "Histogram of Bill Depth of Male Chinstrap Penguins",
     xlab = "Bill depth Distribution in mm",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1,2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(15,22),
     
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilldepthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilldepthchinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilldepthchinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```


```{r echo=FALSE}




# Create a histogram
hist(chinstrapfemale$"Culmen Depth (mm)",
     main = "Histogram of Bill depth of Female Chinstrap Penguins",
     xlab = "Bill depth Distribution in mm",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(15,22),
     ylim= c(0.0,0.6),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanbilldepthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanbilldepthchinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```

```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(4, 4, 2, 1), oma = c(2, 2, 2, 1))

# Histogram for male chinstrap penguins' bill depth
hist(chinstrapmale$"Culmen Depth (mm)",
     main = "",
     xlab = "Bill Depth (mm)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(15, 22),
     ylim= c(0.0, 0.6),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanbilldepthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapmale, col = "blue", lwd = 2, lty = 2)

# Histogram for female chinstrap penguins' bill depth
hist(chinstrapfemale$"Culmen Depth (mm)",
     main = "",
     xlab = "Bill Depth (mm)",
     ylab = "",
     col = "lightpink",
     xlim = c(15, 22),
     ylim= c(0.0, 0.6),
     freq = FALSE)


# Add density line for female
lines(density(chinstrapfemale$"Culmen Depth (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanbilldepthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianbilldepthchinstrapfemale, col = "blue", lwd = 2, lty = 2)

# Add a common main title above the plots
mtext("Bill Depth of Male and Female Chinstrap Penguins", side = 3, line = 1, outer = TRUE)

# Since we have a shared title, we remove the individual main titles by setting `main = ""` in the `hist` functions.

# Add a shared legend below the plots
# Add legend
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)


# Reset par to default for further plots
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))


```


## Histogram flipperlength
```{r echo=FALSE}




# Create a histogram
hist(chinstrapmale$"Flipper Length (mm)",
   
     main = "Histogram of Flipper Length of Male Chinstrap Penguins",
     xlab = "Flipper Length Distribution in mm",
     ylab = "Density",
     col = "cyan1",
     mar = c(2, 1,2, 1),
     oma = c(2, 1, 2, 1),
     xlim=c(170,220),
     
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapmale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanflipperlengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanflipperlengthchinstrapfemale, col = "black", lwd = 2, lty = 1)
abline(v = medianflipperlengthchinstrapfemale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean male", "Median male", "Mean female", "Median female"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.8)


```


```{r echo=FALSE}




# Create a histogram
hist(chinstrapfemale$"Flipper Length (mm)",
     main = "Histogram of Flipper length of Female Chinstrap Penguins",
     xlab = "Flipper Length Distribution in mm",
     ylab = "Density",
     col = "lightpink",
     mar = c(2, 1, 2, 1),
     oma = c(2, 1, 2, 1),
     xlim = c(170,220),
     #ylim= c(0.0,0.6),
     freq = FALSE, # Using density instead of frequency
      # Set x-axis limits to cover full data range
     )     # Do not plot x-axis yet


# Add density line
lines(density(chinstrapfemale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines
abline(v = meanflipperlengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 2)
abline(v = meanflipperlengthchinstrapmale, col = "black", lwd = 2, lty = 1)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 1)

# Add legend
legend("topright", legend = c("Density", "Mean female", "Median female", "Mean male", "Median male"), 
       col = c("black", "black", "blue", "black", "blue"), lty = c(1, 2, 2, 1, 1), lwd = 2,cex=0.75)

```


```{r echo=FALSE, fig.align='center'}
# Set up the plotting area to have 1 row and 2 columns
par(mfrow=c(1, 2), mar = c(5, 4, 4, 2) + 0.1, oma = c(0, 0, 2, 0))

# Histogram for male chinstrap penguins' flipper length
hist(chinstrapmale$"Flipper Length (mm)",
     main = "",
     xlab = "Flipper Length (mm)",
     ylab = "Density",
     col = "cyan1",
     xlim = c(170, 220),
     ylim= c(0, 0.08),
     freq = FALSE)

# Add density line for male
lines(density(chinstrapmale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for male
abline(v = meanflipperlengthchinstrapmale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapmale, col = "blue", lwd = 2, lty = 2)

# Histogram for female chinstrap penguins' flipper length
hist(chinstrapfemale$"Flipper Length (mm)",
     main = "",
     xlab = "Flipper Length (mm)",
     ylab = "",
     col = "lightpink",
     xlim = c(170, 220),
     ylim= c(0, 0.08),
     freq = FALSE)

# Add density line for female
lines(density(chinstrapfemale$"Flipper Length (mm)", na.rm = TRUE), col = "black", lwd = 2)

# Add mean and median lines for female
abline(v = meanflipperlengthchinstrapfemale, col = "black", lwd = 2, lty = 2)
abline(v = medianflipperlengthchinstrapfemale, col = "blue", lwd = 2, lty = 2)

# Add a common main title and a legend
mtext("Histogram of Flipper Length of Chinstrap Penguins", side = 3, line = 1, outer = TRUE)
legend("topright", inset=c(-0.1, 0), 
       legend = c("Density", "Mean", "Median"), 
       col = c("black", "black", "blue"), lty = c(1, 2, 2), lwd = 2, cex=0.75, bty="n", xpd=TRUE)

# Reset par to default for further plots
par(mfrow=c(1, 1), mar = c(5, 4, 4, 2) + 0.1, oma = c(2, 1, 2, 1))


```




